# تصميم محرك التيار المستمر ذو الفرشاة المباشرة

عادةً ما نستخدم تحكم PWM في دائرة H-Bridge للتحكم في اتجاه وسرعة محرك التيار المستمر ذو الفرشاة المباشرة، ونسبة نبض التوقف في PWM تتناسب مع سرعة المحرك.

## المعرفة الأساسية عن دائرة H-Bridge

دائرة H-Bridge هي نوع من الدوائر الجسرية التي يمكنها تبديل قطبية الجهد على الحمل بسرعة. تُستخدم هذه الدوائر عادةً لتشغيل محركات التيار المستمر ذات الفرشاة المباشرة لتدور في اتجاه عقارب الساعة أو عكس اتجاه عقارب الساعة. ونظرًا لأن هيكلها يشبه حرف "H"، فإنها تسمى دوائر H-Bridge.

تتكون دائرة H-Bridge من أربعة مفاتيح، حيث تتكون S1 و S3 من مفاتيح الجهد العالي في دائرة H-Bridge (High-Side Switch)، وعادةً ما تكون عبارة عن مفاتيح MOSFET من النوع P أو ترانزستورات PNP، وتتكون S2 و S4 من مفاتيح الجهد المنخفض في دائرة H-Bridge (Low-Side Switch)، وعادةً ما تكون عبارة عن مفاتيح MOSFET من النوع N أو ترانزستورات NPN.

![](https://media.wiki-power.com/img/20210812093751.png)

- عند إغلاق المفاتيح S1 و S4 وفتح المفاتيح S2 و S3، يدور المحرك بشكل طبيعي في اتجاه موجب، ويُعرف هذا باتجاه الدوران الموجب.
- عند إغلاق المفاتيح S2 و S3 وفتح المفاتيح S1 و S4، يدور المحرك في اتجاه عكسي، ويُعرف هذا باتجاه الدوران العكسي.
- عند إغلاق المفاتيح S1 و S2 أو S3 و S4، يحدث اختصار في الدائرة الكهربائية مما يؤدي إلى خطر تلف مصدر الطاقة، ويجب تجنب حدوث مثل هذه الحالة. يُعرف هذا الحالة بـ "الاختراق" (Shoot-Through).
- عند إغلاق المفاتيح S1 و S3 وفتح المفاتيح S2 و S4، أو إغلاق المفاتيح S2 و S4 وفتح المفاتيح S1 و S3، لا يدور المحرك. في هذه الحالة، يكون المحرك في وضع "الفرملة"، حيث يتم توجيه الجهد العكسي الناتج عن الحركة الدورانية للمحرك إلى اختصار الدائرة الكهربائية، مما يعمل كفرملة.
- عند فتح جميع المفاتيح S1 و S2 و S3 و S4، يكون المحرك في وضع الانزلاق ويستمر في الدوران لفترة طويلة.

في الدائرة الفعلية، يمكننا استخدام رقاقة تحكم للتحكم الدقيق في أربعة مفاتيح MOS.

## اختيار البناء المنفصل أو رقاقة متكاملة

بالمقارنة مع استخدام رقاقة تحكم متكاملة، بناء الدائرة باستخدام المكونات المنفصلة يكلف أقل ويوفر مزيدًا من التخصيص. عمومًا، يتم إخراج إشارة PWM من وحدة المعالجة المركزية (MCU) لتحكم المحرك، ثم يتم تمريرها من خلال عزل الضوء والدوائر المنطقية، ثم إلى رقاقة التحكم، وأخيرًا إلى المفاتيح MOS للجسر الكامل / الجسر النصف.

ومع ذلك، يجب مراعاة العديد من الأمور عند استخدام المكونات المنفصلة لبناء تشغيل المحرك، مثل التحكم في المنطقة الميتة (لمنع الاختراق) وتحكم في الجهد المناسب للتشغيل وتصميم الحماية وغيرها، مما يزيد من تعقيد التصميم الكهربائي ويزيد من مساحة الدائرة المطلوبة على اللوحة الدوائر المطبوعة (PCB) ويزيد من التكلفة ويزيد من مخاطر التصميم.

عادةً ما نستخدم رقاقة تحكم H-Bridge متكاملة لتحكم في محرك التيار المستمر ذو الفرشاة المباشرة عند تشغيله.

## اختيار نوعية المفاتيح MOS

في تشغيل المحرك الكهربائي، نستخدم عادةً مفاتيح MOS من نوع N المحسن. والأسباب كما يلي:

1. اختيار المفاتيح المحسن: يمكن إغلاقها تمامًا عند مستوى الجهد المنخفض، وعندما يكون المستوى أعلى من الجهد المفتوح $U_{GS(TH)}$، يمكن أن توصل بشكل كامل.
2. اختيار المفاتيح من نوع N: لأن اختيار نماذج المفاتيح من نوع P أقل والأسعار أعلى والمقاومة الموصلية أكبر، مما يؤدي إلى إنتاج حرارة عالية وكفاءة منخفضة.
3. اختيار المفاتيح MOS: المفاتيح MOS أقل فقدانًا للطاقة من الثنائي القطبي الثنائي (BJT)، وأصغر حجمًا، وتيار تشغيل أكبر، واستجابة أسرع، ومقاومة موصلية أقل.

في التصميم الفعلي، ولتبسيط المواد المستخدمة، عادةً ما نستخدم المفاتيح من نوع N بالكامل. ومع ذلك، نظرًا لأنه لا يمكن استخدام المفاتيح من نوع N مباشرة للتحكم في الجهد العالي لدائرة H-Bridge (نظرًا لأن شرط توصيل المفتاح N-MOS هو $V_g-V_s>V_{gs(th)}$)، فإنه يتطلب تصميم دائرة تشغيل عائمة للجهد العالي (نظرًا لأنها بنية بسيطة) لتشغيل المفتاح العلوي. لمزيد من التفاصيل حول دائرة التشغيل العائمة، يرجى الانتقال إلى المقالة [**تصميم الطاقة - دائرة التشغيل العائمة**](https://wiki-power.com/%E7%94%B5%E6%BA%90%E8%AE%BE%E8%AE%A1-%E8%87%AA%E4%B8%BE%E7%94%B5%E8%B7%AF).

المعلمات المهمة التي يجب مراعاتها عند اختيار المفاتيح MOS من نوع N:

- $V_{DSS}$
- $R_{DS(on)}$

## رقاقة تحكم H-Bridge المتكاملة

عادةً م

## 一般我们使用门极驱动芯片为高压 / 低压侧功率 N-MOS 管提供驱动栅极的电源（根据数据手册，必须使其高于 MOS 管的 $U_{GS(TH)}$，漏极 D 和源极 S 之间才能导通）。举个例子，下图是 DRV8701 门极驱动的参数：

![](https://media.wiki-power.com/img/20210811095012.png)

配合 IRFH8330 使用，可以带得动这个 MOS 管：

![](https://media.wiki-power.com/img/20210811095429.png)

## PWM 频率的选择

使用 PWM 信号控制电机速度时，需要注意其频率。若频率过低，电机在低速时会产生噪音，而且对占空比的变化也会显得反应迟缓。而如果 PWM 的频率过高，会在 H 桥的 MOSFET 上产生较大的开关损耗。

如果 H 桥驱动芯片的规格书中没有给出具体频率范围的话，一般来说 4kHz-200kHz 左右的 PWM 信号都可以较理想地控制电机的转速。

## 死区时间插入和交叉传导（直通）保护

死区可以简单理解为一个延时，使正转时导通的上桥完全关断时再打开反转时需要打开的下桥。死区过小会导致危险，死区过大会导致电机响应不好，电源的利用效率低等问题。

![](https://media.wiki-power.com/img/20210815112048.jpg)

使用集成方案：纳入自动握手，以便利用最佳的死区时间，而不受回转率、电压、MOS 特性和温度的影响。握手是一个多步骤的过程，确保利用最佳的死区时间，并且不发生交叉传导。握手的过程：

1. 接收信号，以从高端 MOS 到低压侧 MOS
2. 禁用高端 MOS，并监测 $V_{GS}$ 以确定什么时候禁用它
3. 插入死区时间，启用低压侧 MOS

## H 桥的衰减模式

衰减模式，是指走哪个续流回路，使电机停下来。因为直流电机属于感性负载（电感电流不能突变），想让电机停下，除了断开供电，还需要形成一个续流的回路，释放掉电机上的能量，否则电机产生的续流有可能损坏 MOS 管。

### 异步与同步衰减

我们可以使用二极管来构建续流回路，如图：

![](https://media.wiki-power.com/img/20211222162216.png)

而我们知道，MOS 管内本身有体二极管可以充当续流回路，在有些应用中，也会外加并联肖特基二极管，所以可以借其实现续流衰减。用二极管实现衰减的模式被称为异步衰减。但异步衰减的损耗会相对大（$2*I*V_D$），所以我们引出另一种衰减途径，叫同步衰减。同步衰减是通过打开 MOS 管实现续流。因为 MOS 管的导通电阻 $R_{ds(on)}$ 小，所以同步衰减损耗会相对小（$I^2*R_{ds(on)*2}$），下面将主要讲解同步衰减。

![](https://media.wiki-power.com/img/20211222172558.png)

### 关键参数

![](https://media.wiki-power.com/img/20211222172913.png)

- $I_{TRIP}$：当前驱动芯片设定的电流，受驱动算法控制；
- $T_{DRIVE}$：驱动阶段的时间
- $T_{BLANK}$：死区阶段时间，为了防止射穿
- $T_{OFF}$：续流阶段

### 同步衰减的三种模式

同步衰减有三种模式：快衰减（Fast Decay）、慢衰减（Slow Decay）和混合衰减（Mixed Decay）。这里的快慢指的是续流期间电流衰减的相对速度，而非电机的转速。

三种模式的区别：

|                             | الانخفاض السريع                        | الانخفاض البطيء                    | الانخفاض المختلط                 |
| --------------------------- | -------------------------------------- | ---------------------------------- | -------------------------------- |
| تموج التيار الفازي          | كبير                                   | صغير                               | متوسط                            |
| وقت مرحلة التواصل $T_{OFF}$ | قصير (قد يؤدي إلى زيادة خسارة التبديل) | طويل (قد تسمع ضجيجًا منخفض التردد) | متوسط (توازن بين التردد والأداء) |
| سرعة انخفاض التيار الفازي   | سريع                                   | بطيء                               | متوسط                            |
| نطاق الاستخدام              | مناسب لمحركات ذات ملف لفائف كبيرة      | مناسب لمحركات ذات ملف لفائف صغيرة  | متوسط                            |

#### الانخفاض السريع

![](https://media.wiki-power.com/img/20211223154627.png)

عملية الانخفاض السريع هي إغلاق المفاتيح MOSFET الاثنين للتحكم، ثم انتظار فترة الزمن الميت ومن ثم فتح المفاتيح MOSFET المتناظرة لتفريغ التيار بسرعة. خلال فترة الزمن الميت، سيتم تناقص الجسر العلوي بشكل غير متزامن، ولكن يمكن تجاهلها بسبب قصر الوقت.

#### الانخفاض البطيء

![](https://media.wiki-power.com/img/20211223160616.png)

عملية الانخفاض البطيء هي إغلاق المفاتيح MOSFET الاثنين للتحكم، ثم انتظار فترة الزمن الميت ومن ثم فتح المفاتيح السفلية لتفريغ التيار ببطء. بنفس الطريقة، سيتم تناقص الجسر العلوي بشكل غير متزامن خلال فترة الزمن الميت، ولكن يمكن تجاهلها بسبب قصر الوقت.

#### الانخفاض المختلط

عملية الانخفاض المختلط هي إغلاق المفاتيح MOSFET الاثنين للتحكم، ثم انتظار فترة الزمن الميت ومن ثم فتح المفاتيح MOSFET المتناظرة (انخفاض سريع) لتفريغ التيار بسرعة، ثم فتح المفاتيح السفلية (انخفاض بطيء) لتفريغ التيار ببطء. في وضعية الانخفاض المختلط، يكون تموج التيار الفازي في نطاق ما بين الانخفاض السريع والانخفاض البطيء.

## مشاكل ومعالجة تشويش تشغيل المحرك

نظرًا لأن المحركات العاصمة تعتبر أحمال ذات طبيعة حساسة (لا يمكن تغيير تيار الحث بشكل مفاجئ)، يمكن وضع سعة كبيرة (أكبر من 100 ميكروفاراد) على مصدر جهد المحرك لامتصاص التيار الدوراني الناتج عن الفرملة الديناميكية للمحرك العاصمة وتثبيت مصدر جهد المحرك أثناء تبديل الاتجاه.

مشكلة أخرى هي أن الملف الحثي الكهربائي (الملف الحثي + المقاومة) بين مصدر جهد المحرك وخط الطاقة للوحة تشغيل المحرك يشكل مجموعة LC مترددة، وعند توصيل مصدر جهد المحرك بلوحة تشغيل المحرك، إذا كانت السعة المحلية غير كافية، فقد ينخفض جهد المحرك بسرعة ويتم تنشيط LC المترددة وتظهر ذروة الاهتزاز. لتقليل ذروة التشويش الناتجة عن توافق LC في خط الطاقة، يمكن وضع سعة تجاوزية 0.1 ميكروفاراد (عادة ما تكون سعة السيراميك) بالقرب من دبوس مصدر طاقة رقاقة تشغيل جسر H للمحرك.

مثال مرجعي:

![](https://media.wiki-power.com/img/20211222150738.png)

بالإضافة إلى ذلك، يمكن وضع حلقة مغناطيسية على خط المحرك لتقليل التداخل المشترك (تم اختباره بشكل واضح).

## المراجع والشكر

- [مدار تشغيل الجسر الكامل المكون من 4 أجهزة N-MOS](https://www.fanyedu.com/content/90.html)
- [شرح مفصل حول تصميم محرك الفرشاة في مسابقة ROBOCON](https://zhuanlan.zhihu.com/p/27547384)
- [نقاش مبسط حول مدار تشغيل محرك الفرشاة المباشرة](https://haipeng.me/2021/02/28/h-bridge-driver/)
- [أوضاع التدهور البطيء والمختلط والسريع. لماذا نحتاج إلى تعقيد الأمور؟](https://ebldc.com/?p=86)
- [إتقان تدفق التيار وأوضاع التدهور والفرملة في تشغيل المحركات](https://www.ti.com.cn/cn/lit/an/zhcaa31/zhcaa31.pdf)
- [تدفق التيار المستدام وأوضاع التدهور](https://www.ti.com/lit/an/slva321a/slva321a.pdf)

> عنوان النص: <https://wiki-power.com/>
> يتم حماية هذا المقال بموجب اتفاقية [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by/4.0/deed.zh)، يُرجى ذكر المصدر عند إعادة النشر.

> تمت ترجمة هذه المشاركة باستخدام ChatGPT، يرجى [**تزويدنا بتعليقاتكم**](https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new) إذا كانت هناك أي حذف أو إهمال.
