# RobotCtrl - مجموعة تطوير عامة للوحدة STM32

![صورة](https://media.wiki-power.com/img/20220416181125.jpeg)

مستودع المشروع: [**linyuxuanlin/RobotCtrl**](https://github.com/linyuxuanlin/RobotCtrl)

مجموعة RobotCtrl - STM32 للتطوير العام تتضمن ثلاثة لوحات:

- [**RobotCtrl_Core - اللوحة الأساسية**](https://wiki-power.com/RobotCtrl_Core-%E6%A0%B8%E5%BF%83%E6%9D%BF)
- [**RobotCtrl_Core - لوحة توسيع الأجهزة الخارجية**](https://wiki-power.com/RobotCtrl_Func-%E5%A4%96%E8%AE%BE%E6%8B%93%E5%B1%95%E6%9D%BF)
- [**RobotCtrl_Power - لوحة توفير الطاقة**](https://wiki-power.com/RobotCtrl_Power-%E7%94%B5%E6%BA%90%E4%BE%9B%E7%94%B5%E6%9D%BF)

## متطلبات التصميم

![صورة](https://media.wiki-power.com/img/20220527111854.png)

ملاحظة: ما يلي هو ملخص التصميم. للمزيد من التفاصيل، يرجى الانتقال إلى المقالات ذات الصلة.

### فكرة تصميم RobotCtrl_Core

تشمل تصميم الدائرة الكهربائية للوحة الأساسية RobotCtrl_Core دوائر الطاقة، والنظام الدقيق للميكروكنترولر، والاتصال USB، وموصلات B2B، وأزرار المستخدم ومصابيح LED.

تم استخدام LDO في دائرة الطاقة والتي تتميز ببساطة الدائرة وانخفاض التموج في الإخراج وتكلفة منخفضة ومساحة تصميم صغيرة. بالإضافة إلى السعة التنقية المناسبة ومؤشرات الطاقة، يتم تحويل الجهد الوارد من منفذ USB أو موصل B2B إلى 3.3 فولت (بتيار أقصى 1 أمبير).

في تصميم النظام الدقيق، تم توصيل الجهد بقيمة 3.3 فولت وتمت إضافة سعات تنقية مناسبة. بالإضافة إلى ذلك، تم توصيل الجهد VDDA المخصص لمحول ADC بواسطة ملف مغناطيسي بمقاومة 120 أوم وتمت إضافة سعات تنقية إضافية. تمت إضافة دائرة إعادة تعيين خارجية مع زر خارجي لتفعيل مستوى منخفض على دبوس NRST لإعادة تعيين النظام. تمت إضافة دائرة ساعة مع مصدر ساعة خارجي عالي السرعة HSE مع وجود ترانزيستور كريستالي غير نشط على دبوس OSC_IN و OSC_OUT. تم تحديد تشغيل النظام من ذاكرة الفلاش المدمجة على اللوحة افتراضيًا، حيث يتم تعيين BOOT0 إلى المستوى السفلي وBOOT1 إلى أي مستوى آخر باستخدام مقاومة 10 كيلو أوم لجلب BOOT0 إلى الأرض. تم توصيل دائرة التنزيل والتصحيح مباشرة إلى واجهة SW (DIO/CLK).

تم تصميم دائرة الاتصال بواسطة USB للوحة STM32F4 والتي تحتوي على منفذ USB مدمج. تم اختيار منفذ USB Micro للاتصال الخارجي، وتم توصيل مقاومات تيار تدفق 10 أوم على الخطوط الإشارية وخطوط الطاقة على حد سواء، بالإضافة إلى توصيل تلفزيونس ومكثفات حماية ثنائية لكل منهما على التوالي، لتلبية متطلبات التوافق elecromagnetic (EMC).

يتم استخدام موصل B2B لتوفير الطاقة والاتصال بين RobotCtrl_Func. في هذا التصميم، يكفي اثنان من موصلات B2B لتوصيل جميع منافذ الإدخال/الإخراج للميكروكنترولر STM32F407ZE، مما يزيد من إمكانية التوسيع في المرحلة لاحقة.

### فكرة تصميم RobotCtrl_Func

تحتوي دائرة الاتصال للوحة RobotCtrl_Func بشكل رئيسي على الات

تعتمد الاتصال بالإيثرنت على شريحة PHY الإيثرنت واستخدام واجهة RMII للتواصل مع الميكروكنترولر. يتم التواصل من خلال توصيل كبل الإيثرنت الخارجي بمقبس RJ45 الذي يحتوي على محول عزل مدمج. تعتمد دارة الإيثرنت على مصدر زمني خارجي بتردد 25 ميجاهرتز غير نشط، وتحتاج إلى إمداد طاقة مستقل للتقليل من التداخل مع مصدر الطاقة. في هذا المكان، تم استخدام نفس حلا التزويد بالطاقة بالفولتية المنخفضة مثل اللوحة الأم الرئيسية لتوفير الطاقة لدارة الإيثرنت بشكل منفصل.

تتضمن دارة واجهة أربعة مستشعرات للكشف عن المسافة بالأشعة تحت الحمراء توصل إلى الأرضي المشترك (NPN مفتوح دائمًا)، وبالتالي تحتاج إلى توصيلها بجهد 12 فولت الذي يتم توفيره من خلال RobotCtrl_Power، وتضاف إليها أربعة شرائح عزل بالأشعة تحت الحمراء لنقل إشارات الجهد المنخفض والجهد العالي. تصميم الدارة لشرائح العزل بالأشعة تحت الحمراء يتطلب حساب قيمة المقاومة لتحقيق تيار مناسب، مما يضمن التشغيل ضمن نطاق الجهد المطلوب والمحدد في دليل البيانات. تم تصميم وحدة استشعار الوضع باستخدام وحدة MPU6050 وتم تخصيص واجهة I2C للتواصل مع الميكروكنترولر.

### الفكرة الرئيسية لتصميم RobotCtrl_Power

تتكون الدائرة الأساسية لتصميم RobotCtrl_Power من مدخلين للطاقة بمقابس XT60 مزدوجة، حيث يُستخدم أحدهما كمدخل للطاقة، ويمكن توصيل مصدر طاقة احتياطي بالآخر، ويمكن أيضًا استخدامه كمصدر طاقة للبطارية للإمداد الخارجي.

تعتمد دارة الوقاية من الاتصال العكسي على MOSFET لمنع الاتصال العكسي. عند توصيل الطاقة بشكل صحيح، يتم فتح الMOSFET وعندما يتم التوصيل بشكل عكسي، يتم إغلاقه لحماية الدارة. في هذا التصميم، تم استخدام MOSFET من الصنع المحلي لمنع الاتصال العكسي، وتم استخدام المقاومات وثنائيات الصمام لتحديد الجهد على المجمع عندما يكون الMOSFET مفتوحًا. للحماية من فرط الجهد ومن التفريغ الساكن العابر (ESD)، تم توصيل ثنائيات صمام التلفزيون في المدخل.

تم اختيار Buck كحلاً لتحويل الجهد إلى 12 فولت و 5 فولت باستخدام LMR14050. باستناد إلى مبدأ توبولوجيا Buck ومرجعات دليل البيانات لشريحة التثبيت، تم اختيار قيم المقاومات للردود العكسية بحيث يمكن الحفاظ على الإخراج عند 12 فولت و 5 فولت. عند اختيار نموذج الملف اللولبي، يجب مراعاة أن تكون الحالة المشبعة القصوى للتيار أكبر من التيار المتغير، ويجب ترك هامشًا كافيًا. تم اختيار ثنائي الصمام شوتكي لتحقيق التبديل السريع، ويجب أن تتوافق الجهد والتيار مع متطلبات الدارة. بالإضافة إلى ذلك، يجب توصيل مكثفات التمرير الصغيرة على كلا الجانبين لتنقية الطاقة.

يتم التحكم في تشغيل إخراج التثبيت بواسطة مف

> تمت ترجمة هذه المشاركة باستخدام ChatGPT، يرجى [**تزويدنا بتعليقاتكم**](https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new) إذا كانت هناك أي حذف أو إهمال.
