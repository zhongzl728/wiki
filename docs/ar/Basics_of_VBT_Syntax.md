# ุฃุณุงุณูุงุช ุจููุฉ VBT

## ูุงุฆูุงุช ุงูุจูุงูุงุช

### TheHdw ู TheExec

ููุงู ููุงุจุถ ุนุงูููุฉ ุงุซูุชุงู ูู ูุงุฌูุฉ VBT ูุชุดุบูู ุนุชุงุฏ ุงูุงุฎุชุจุงุฑ:

- **TheHdw (ุงูุนุชุงุฏ)**: ูุฏุนู ุงููุตูู ูุงูุชุญูู ูู ุงูุฃุฌูุฒุฉ ููุชุถูู ูุธุงุฆู ุนุงูุฉ ุฃูุซุฑ ููุนุชุงุฏุ ูุซู ุงูุฅูุฐุงุฑุงุช.
- **TheExec (ุงูุชูููุฐู)**: ููุชุญูู ูู ูุธุงุฆู ุจุฑูุงูุฌ ุงูุงุฎุชุจุงุฑ ุงูุนุงูุฉุ ูุซู ุชูููุฐ ุงูุงุฎุชุจุงุฑุ ููุนุงูุฌุฉ ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุ ูุชุณุฌูู ุงูุจูุงูุงุช.

ูููุง ููู ุฃูุซูุฉ ุนูู ุงุณุชุฎุฏุงููู:

```vbscript
' ุชุนููู ุงููุทุงู ุงูุญุงูู ูููููุฐ p0
TheHdw.DCVI.Pins("p0").CurrentRange = 0.002
```

```vbscript
' ุงูุญุตูู ุนูู ูุณุงุฑ ููู ุงูุฅุฎุฑุงุฌ STDF ุงูุญุงูู
CurrStdfFile = TheExec.Datalog.Setup.STDFOutputFile
```

### ูุงุฆูุงุช ุงูุจูุงูุงุช ุงูุฃุฎุฑู

ุชู ุชุถููู ููุงุจุถ ุนุงูููุฉ ุฃุฎุฑู ูู ูุงุฌูุฉ VBTุ ูุซู **PinListData**, **DSPWave**, **RtaDataObj (ูุงุฆู ุจูุงูุงุช ุชุนุฏูู ุงูููุช ุงูุชุดุบููู)** ููุง ุฅูู ุฐูู. ุณูุณุชูุฑ ูู ุงุณุชูุดุงููุง ูู ุงูููุงูุงุช ุงููุณุชูุจููุฉ.

## ุงููุตูู ุจูุงุณุทุฉ ุงูุฃุฏุงุฉ ุฃู ุจูุงุณุทุฉ ุงููููุฐ

ูุฏุนู ุจููุฉ VBT ูุตูู ุนุชุงุฏ ุงูุงุฎุชุจุงุฑ **ุจูุงุณุทุฉ ุงูุฃุฏุงุฉ** ุฃู **ุจูุงุณุทุฉ ุงููููุฐ**ุ ูููุง ููุงูุฆุงู ูู ุงููุชูุฌุฉ. ูููุง ููู ุฃูุซูุฉ ุนูู ุงุณุชุฎุฏุงููู:

```vbscript
' ุงููุตูู ุจูุงุณุทุฉ ุงูุฃุฏุงุฉุ ูุทุจู ุฃุฏุงุฉ ูุงุญุฏุฉ ุนูู ุฃููุงูุฐ ูุฎุชููุฉ
With TheHdw.instrument
    .Pins("Vcc").CurrentLimit = 0.75
    .Pins("Vee").ForceValue = 3.2
End With
```

```vbscript
' ุงููุตูู ุจูุงุณุทุฉ ุงููููุฐุ ูุญุฏุฏ ูุงุฆูุฉ ุงูููุงูุฐ ุซู ูุณุชุฎุฏู ุฃุฏูุงุช ูุฎุชููุฉ
With TheHdw.Pins("Vcc,Vdd,Vee")
    .instrument1.Disconnect
    .instrument2.CurrentLimit = 0.75
End With
```

## ูููู ููุฏ VBT

ูุฌุจ ุชุณููุฉ ููู ููุฏ VBT ุจุงุณู `VBT_xxx`ุ ููุฌุจ ุฃู ูููู ุงูุงุณู ูุฑูุฏูุง.

ููุชููุน ุฃู ูููู **ูููุฉ ุงูุนูุฏุฉ** ููุธููุฉ VBT ุชุณุงูู 0 ุงูุชุฑุงุถููุงุ ุฃู ูุฏ ุชุชุณุจุจ ูู ูุชุงุฆุฌ ุบูุฑ ูุชููุนุฉ.

ูููุนููุงุช ุงููุชุนููุฉ ุจู **ุงูุชูููุช** ู **ุงููุณุชููุงุช**ุ ูููููู ุฅุถุงูุชูุง ูู ูุญุฑุฑ ุงูููุงุฐุฌ ุงููุฑุฏูุฉ ุฃู ูุฑูุฉ ุงูุงุฎุชุจุงุฑ ุงูููุฑูุ ูููุณ ูู ุงูุถุฑูุฑู ุชุถููููุง ูู ูุธููุฉ VBT. ููููู ุงูุชุญูู ูู ุชูููููุง ูู ูุธููุฉ VBT ุนุจุฑ ุงูุงุณุชุฎุฏุงู ุงูุชุงูู:

```vbscript
TheHdw.Digital.ApplyLevelsTiming
```

ุฃูุง ุจุงููุณุจุฉ ูู **ุญุฏูุฏ ุงูุงุฎุชุจุงุฑ**ุ ูููููู ุงุณุชุฎุฏุงู ุงูุดููุฑุฉ ุงูุชุงููุฉ:

```vbscript
TheExec.Flow.TestLimit
```

ูููุงุฑูุฉ ูููุฉ ุงููุชูุฌุฉ ูุน ุงูุญุฏูุฏ ุงูุณููู ูุงูุนููุงุ ูุฅุฑุณุงู ูุชูุฌุฉ ุงูุงุฎุชุจุงุฑ (`TL_SUCCESS`/`TL_ERROR`) ููุนูููุงุช ุฃุฎุฑู ุฅูู ุฏูุชุฑ ุงูุจูุงูุงุช.

ูุฑุคูุฉ **ุงููููู ุงูุฃุณุงุณู** ููุธููุฉ ุงุฎุชุจุงุฑ VBT ุจูุถูุญ ุฃูุจุฑุ ุฅููู ูุซุงู:

```vbscript
Public Function VBTLeakTest(Pins As PinList, ForceVoltage As Double, PrePattern As PatternSet) As Long
    On Error GoTo errHandler

    Dim measure_results As New PinListData

    ' ูู ุจุฅุนุฏุงุฏ ุงูุชูููุช ูุงููุณุชููุงุช ูููุท ุงูุงุณุชุจูุงู
    TheHdw.Digital.ApplyLevelsTiming ConnectAllPins:=True, loadLevels:=True, loadTiming:=True, relaymode:=tlPowered

    ' ูู ุจุชุดุบูู ููุท ุงูุงุณุชุจูุงู ูุงุฎุชุจุงุฑู ูููุฌุงุญ/ุงููุดู
    TheHdw.Patterns(PrePattern).test pfAlways, 0

    ' ูู ุจุชุทุจูู ุงูุฌูุฏ ููู ุจููุงุณ ุงูุชูุงุฑ
    With TheHdw.DCVI.Pins(Pins)
        .Mode = tlDCVIModeVoltage
            ... ' ุงูุดููุฑุฉ ุงูุฅุถุงููุฉ
        measure_results = .Meter.Read
    End With

    ' ุงุฎุชุจุฑ ุจุงุณุชุฎุฏุงู ุงูุญุฏูุฏ ูู ุงูุณูุฑ ูุงูุชุจ ุฏูุชุฑ ุงูุจูุงูุงุช
    Call TheExec.Flow.TestLimit(resultval:=measure_results, unit:=unitAmp, forceval:=ForceVoltage, forceunit:=unitVolt, ForceResults:=tlForceFlow)

    ' ุฃุนุฏ ุชุนููู ุงููุชุบูุฑ
    measure_results = Nothing

    Exit Function
errHandler:
    If AbortTest Then Exit Function Else Resume Next
End Function
```

## ูุชุนุฏุฏ ุงูููุงูุน

๐ง

## ุนูููุงุช PinList

๐ง

## ูุตุงุฆุญ ูู VBA


ุชุฌูุจ ุญูุธ ุงูููุฏ ูู VBAุ ูุฃู ุฐูู ุณูุฎูู ุฑูุงุจุท ุฏุงุฎููุฉ ุตุนุจุฉ ูู ูุตูู ุงูุนูู. ุจุฏูุงู ูู ุฐููุ ุงุญูุธู ูู ูุงุฌูุฉ DataTool.
ุฅุฐุง ูุงุฌูุช ุฎุทุฃ "ุงูุฅุฌุฑุงุก ูุจูุฑ ุฌุฏูุง"ุ ููุฏ ุชููู ุถุฏ ุงููููุฏ ุงูุชู ุชูุฑุถูุง ุฅูุณู ุจุญุฏ ุฃูุตู 64 ููููุจุงูุช ููู ููู VBA. ูููู ูู ุงููุงูุนุ ูู ุงููููู ุฃูู ูุณูุช ุชุบููุฑ ุงููุณุฎุฉ ูู 32 ุจุช ุฅูู 64 ุจุช ูู ูุธุงู ูููุฏูุฒ.

> ุชูุช ุชุฑุฌูุฉ ูุฐู ุงููุดุงุฑูุฉ ุจุงุณุชุฎุฏุงู ChatGPTุ ูุฑุฌู [**ุชุฒููุฏูุง ุจุชุนูููุงุชูู**](https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new) ุฅุฐุง ูุงูุช ููุงู ุฃู ุญุฐู ุฃู ุฅููุงู.