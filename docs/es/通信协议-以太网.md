# Protocolo de comunicaci칩n - Ethernet 游뚾

## Referencias y agradecimientos

- [Apuntes de autoaprendizaje sobre PHY Ethernet](https://zhuanlan.zhihu.com/p/102296622)
- [[Circuitos] Capa f칤sica PHY de Ethernet](https://zhenhuizhang.tk/post/dian-lu-yi-tai-wang-phy-wu-li-ceng/)

> Direcci칩n original del art칤culo: <https://wiki-power.com/>
> Este art칤culo est치 protegido por la licencia [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by/4.0/deed.zh). Si desea reproducirlo, por favor indique la fuente.

## Hardware de Ethernet embebido

El hardware de Ethernet embebido en un sistema embebido est치 compuesto principalmente por los siguientes componentes: controlador MAC, chip PHY, transformador de red y conector RJ45. Algunos sistemas tambi칠n pueden incluir un controlador DMA.

![](https://media.wiki-power.com/img/20220627163525.png)

Por lo general, la CPU/MCU integra el controlador MAC en el chip (el MAC es un circuito digital y, debido a consideraciones de 치rea de chip y arquitectura, generalmente se integra en el chip), por lo que los componentes que deben dise침arse externamente son el PHY, el transformador y la interfaz. En muchos casos, el transformador de red tambi칠n se integra en el conector RJ45.

### MAC

El MAC (Protocolo de control de acceso al medio, Media Access Control) se encuentra en la capa de enlace de datos de la estructura de siete capas del modelo OSI y es responsable de controlar y conectar el medio f칤sico. El MAC sigue el est치ndar IEEE-802.3.

![](https://media.wiki-power.com/img/20220627171622.png)

Al enviar datos, el protocolo MAC puede determinar de antemano si se pueden enviar datos. Si es posible, agrega informaci칩n de control a los datos y luego env칤a los datos y la informaci칩n de control en un formato especificado a la capa f칤sica.

Al recibir datos, el protocolo MAC primero verifica la informaci칩n de entrada y si se produjeron errores de transmisi칩n. Si no hay errores, elimina la informaci칩n de control y la env칤a a la capa LLC.

### PHY

PHY es el transceptor de interfaz f칤sica que implementa la capa f칤sica de Ethernet. El PHY est치 definido por el est치ndar IEEE-802.3 e incluye la subcapa de interfaz independiente del medio MII/GMII, la subcapa de codificaci칩n f칤sica PCS, la subcapa de anexo f칤sico PMA, la subcapa relacionada con el medio f칤sico PMD y la subcapa MDI.

Al enviar datos, el PHY recibe los datos transmitidos desde el MAC (para el PHY, no hay concepto de trama, solo datos sin importar la direcci칩n, los datos o el CRC. Para 100BaseTX, debido al uso de codificaci칩n 4B/5B, se agrega un c칩digo de detecci칩n de errores de 1 bit por cada 4 bits), luego convierte los datos paralelos en datos de flujo serie, los codifica seg칰n las reglas de codificaci칩n de la capa f칤sica y los convierte en se침ales anal칩gicas para enviarlos. El proceso es inverso al recibir datos. A continuaci칩n se muestra un diagrama de la estructura interna t칤pica de un PHY (RTL8211E):

![](https://media.wiki-power.com/img/20220627171548.png)

### Protocolo de interfaz entre MAC y PHY

> Este post est치 traducido usando ChatGPT, por favor [**feedback**](https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new) si hay alguna omisi칩n.
